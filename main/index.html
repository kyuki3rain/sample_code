<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Sample Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="../common.css" />
    <style>
      .questionLink {
        font-size: 5vh;
        margin: 1vh;
      }
      #next {
        display: none;
        margin: 3vh;
      }
      #reset {
        display: none;
        font-size: 3vh;
      }
    </style>
    <script type="text/javascript">
      onload = () => {
        if (localStorage.stageFlag == null) {
          localStorage.stageFlag = new Array(4).fill(0);
        }
        // localStorageは文字列でしか入らないので、splitで配列に直し、要素もNumberで数字に戻す必要があります。
        if (
          localStorage.stageFlag
            .split(",")
            .reduce((p, c) => Number(p) + Number(c)) >= 4
        ) {
          document.getElementById("next").style.display = "flex";
        }
        if (
          localStorage.stageFlag
            .split(",")
            .reduce((p, c) => Number(p) + Number(c)) >= 1
        ) {
          document.getElementById("reset").style.display = "flex";
          document.getElementById("reset").addEventListener("click", () => {
            localStorage.stageFlag = new Array(4).fill(0);
            location.href = "index.html";
          });
        }
        [].forEach.call(
          document.getElementsByClassName("questionLink"),
          (q, i) => {
            q.addEventListener("click", () => {
              location.href = "stage" + (i + 1) + "/index.html";
            });
          }
        );
      };
      function goToNextStage() {
        location.href = "../stage2/index.html";
      }
    </script>
  </head>
  <body>
    <div class="header">
      <div id="headerLeft"></div>
      <div id="headerRight"></div>
    </div>
    <div class="main">
      <div class="questionLink">stage1</div>
      <div class="questionLink">stage2</div>
      <div class="questionLink">stage3</div>
      <div class="questionLink">stage4</div>
      <input
        type="button"
        class="wideButton"
        id="next"
        onClick="goToNextStage()"
        value="go to next stage!"
      />
      <div id="reset">リセットする</div>
    </div>
    <div class="footer">
      <div id="backHome">Homeに戻る</div>
    </div>
  </body>
</html>
